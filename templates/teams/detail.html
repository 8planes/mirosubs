{% extends "base.html" %}

{% load i18n teams_tags paginator profiles_tags widget %}

{% block title %}
    {{ team }} | Universal Subtitles
{% endblock %}

{% block body_attrs %}id="teams"{% endblock %}

{% block css %}
    {{ block.super }}
    <link href="{{ MEDIA_URL }}css/mirosubs-widget.css" media="all" type="text/css" rel="stylesheet" />
{% endblock %}

{% block scripts %}
    {{ block.super }}
    {% include "widget/_js_onsite_dependencies.html" %}
{% endblock %}

{% block main_content %}
<div class="grid_8 alpha">
    <h2>{{ team }}</h2>
    
    {% if team.video %}
        {% widget widget_params %}
    {% endif %}
    
    <ul class="video_tabs">
        <li class="active">
            <span class="tab-item">
                {% trans 'Videos' %}<span class="badgy_out"><span class="badgy">{{ team.videos_count }}</span></span>
            </span>
        </li>
        <li>
            <a href="{% url teams:detail_members team.slug %}">
                {% trans 'Members' %}<span class="badgy_out"><span class="badgy">{{ team.member_count }}</span></span>
            </a>
        </li>
    </ul>
    <div id="videos-tab">
        <div class="boxx">
            <div class="padding_small">
                <div class="inline_search">
                    <form>
                        <input type="text" name="q" value="{{ query|default:'' }}">
                        <button class="green_button big">
                            {% trans 'Search' %}
                        </button>
                    </form>
                </div>
                <div class="clearfix">
                </div>
            </div>
        </div>
        <div class="grid_8 clearfix">
            <br/>
            <br/>
        </div>
        {% if is_paginated %}{% paginator %}{% endif %}
        <ul class="big_list">
            {% for team_video in teamvideo_list %}
            <li>
                <a href="{{ team_video.video.get_absolute_url }}" class="thumbnail_medium">
                    <img height="100" src="{{ team_video.get_thumbnail }}">
                </a>
                <div class="info">
                    <h4><a href="{{ team_video.video.get_absolute_url }}">{{ team_video }}</a></h4>
                    {% if team_video|can_edit_video:user %}
                        <a href="{{ team_video.get_absolute_url }}">{% trans 'Edit' %}</a>
                    {% endif %}
                    {% if team_video.description %}
                    <p>
                        {{ team_video.description|urlize }}
                    </p>
                    {% endif %}
                    {% if team_video.languages.incomplete.exists %}
                    <div class="need_help">
                        <span>{% trans 'We need your help with' %}</span>
                        {% if team_video.all_languages %}
                            <a href="{{ team_video.link_to_page }}">{% trans 'All Languages' %}</a>
                        {% else %} 
                            {% for lang in team_video.languages.incomplete %}
                                <a href="{{ lang.get_absolute_url }}">{{ lang }}</a>{% if not forloop.last %}, {% endif %}
                            {% endfor %}
                        {% endif %}
                    </div>
                    {% endif %}
                    <div class="completed_in">
                        {% if team_video.languages.complete.exists %}
                            <span>{% trans 'Subtitles completed in' %}</span>
                            {% for lang in team_video.languages.complete %}
                                <a href="{{ lang.get_absolute_url }}">{{ lang }}</a>{% if not forloop.last %}, {% endif %}
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
            </li>
            {% endfor %}
        </ul>
        {% if is_paginated %}{% paginator %}{% endif %}
    </div>
</div>


<div class="grid_4 omega">
    {% if not team.video %}
    <div class="team_logo">
        {% if team.logo %}
        <img alt="{{ team }}" title="{{ team }}" src="{{ team.logo_thumbnail }}"/>
        {% endif %}
    </div>
    {% endif %}
    {% if team.description %}
    <p>
        <b>{% trans 'Team Description' %}:</b> {{ team.description|urlize }}
    </p>
    {% endif %}
    <p>
        <b>{% trans 'Team Managers' %}:</b>
        {% for item in team.members.managers %}
            <a href="{{ item.user.get_absolute_url }}">{{ item.user }}</a>{% if not forloop.last %},{% endif %}
        {% endfor %}
    </p>
    <p>
        <b>{% trans 'Video Policy' %}:</b>
        {{ team.get_video_policy_display }}
    </p>
    <p>
        <b>{% trans 'Membership Policy' %}:</b>
        {{ team.get_membership_policy_display }}
    </p>    
    {% if team|is_team_member:user %}
        <p><a href="{{ team.get_edit_url }}">{% trans "Manager's Settings & Controls" %}</a></p>
    {% endif %}       

    {% team_activity team %}
</div>

{% endblock %}