{% extends "base.html" %}

{% load escapejs paginator widget i18n recent_activity %}

{% block main_content %}
    <div class="grid_8 alpha">
        <form method="get" action=".">
          {% comment %}
          <ul class="video_tabs">
            <li><a class="active" href="#">{% trans "Videos" %}</a></li>
            <li><a href="#">{% trans "Members" %}</a></li>#}
          </ul>
          {% endcomment %}
          
          <div class="boxx">
            <div class="padding_small">
              
              <div class="inline_search large">
                  {{ form.q }}
                  <button class="green_button big">{% trans "Search" %}</button>
              </div>
              
              <div class="clearfix"></div>
            </div>
          </div>
        
        <div class="grid_8 alpha">
          <div class="search_filters clearfix">
            <p>
              {% trans "Search for videos in" %}
              {{ form.video_lang }}          
              {% trans "subtitled into" %}
              {{ form.langs }}
            </p>
			<script type="text/javascript">
				(function($){
					var vl = $('#id_video_lang option[value=not_selected]');
					var sl = $('#id_langs option[value=not_selected]');
					
					var callback = function(event){
						var el = event.data.el;
						var o = $('option:selected', $(this));
						
						if (o.attr('value') == ''){
							if (el.attr('selected')){
								el.parent().val('my_langs').trigger('change');
							};
							el.hide();
							el.attr('selected', false);
						}else{
							el.html('not '+o.html())
							el.show();
						}
					}
					
					$('#id_video_lang').bind('change', {'el': sl}, callback).trigger('change');

					$('#id_langs').bind('change', {'el': vl}, callback).trigger('change');
					
				})(jQuery);
			</script>
            <p class="last">
            {% comment %}
              {% trans "Display" %}  
              {{ form.display }}
			{% endcomment %}
              {% trans "Sort by" %}
              {{ form.sort }}
            </p>
          </div>
        </div>        
        </form>
        
        <div class="grid_8 clearfix"><br /></div>
        
        {% if is_paginated %}{% paginator %}{% endif %}
        <ul class="big_list">
            {% for object in result_list %}
                {% if object.object %}
                    {% with object.object as video %}
                        {% include 'search/_video_item.html' %}
                    {% endwith %}
                {% else %}
                    {% with object as video %}
                        {% include 'search/_video_item.html' %}
                    {% endwith %}                
                {% endif %}
            {% empty %}
                {% if query %}
                    {% blocktrans %}No results for "{{ query }}".{% endblocktrans %}
                {% endif %}
            {% endfor %}            
        </ul>
        {% if is_paginated %}{% paginator %}{% endif %}
    </div>

      <div class="grid_4 omega">
        <h3>{% trans "Recent activity" %}</h3>
          
        {% recent_activity %}
      </div>        
{% endblock %}