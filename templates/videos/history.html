{% extends "base.html" %}

{% load escapejs paginator widget %}

{% block css %}
    {{ block.super }}
    <link href="{{ MEDIA_URL }}css/mirosubs-widget.css" media="all" type="text/css" rel="stylesheet" />
    <style>
        div.mirosubs-widget {
            position: relative;
        }
        
        .mirosubs-videoDiv {
            text-align: center;
        }
        
        .mirosubs-videoDiv video {
            width: 460px;
        }
        
        #embed {
            white-space: pre;
            background: #eee;
            boder: #666;
        }
    </style>
{% endblock %}

{% block scripts %}
    {{ block.super }}
    {% include "widget/_js_onsite_dependencies.html" %}
    <script type="text/javascript">
        //create url template
        var DIFFING_URL = function(){
            var url = '{% block diffing_link %}{% url videos:diffing 11111 22222 %}{% endblock %}';
            return url.replace(/11111/, '<<first_pk>>').replace(/22222/, '<<second_pk>>');
        }();
        
        function get_compare_link(first_pk, second_pk){
            //set values from arguents
            return DIFFING_URL.replace(/<<first_pk>>/, first_pk).replace(/<<second_pk>>/, second_pk);
        }
        
        jQuery(document).ready(function($){
            $('.version_checkbox:first').attr('checked', 'checked');
            
            $('.version_checkbox').change(function(){
                var $this = $(this);
                var checked_length = $('.version_checkbox:checked').length;
                
                if ($this.attr('checked') && (checked_length > 2)) {
                    $this.attr('checked', '');
                }
            });
            
            $('.compare_versions_button').click(function(){
                var $checked = $('.version_checkbox:checked');
                if ($checked.length !== 2) {
                    alert('Select two revisions for compare, please');
                }
                else {
                    var url = get_compare_link($checked[0].value, $checked[1].value);
                    window.location.replace(url);
                }
            });
            //******** Tabs ********//
            var $last_active_tab = $('#revision-tab');
            $('.video_tabs a').click(function(){
                $last_active_tab.hide();
                $last_active_tab = $($(this).attr('href')).show();
                $('.video_tabs li').removeClass('active');
                $(this).parent('li').addClass('active');
                return false;
            });
        });
    </script>
{% endblock %}

{% block main_content %}
    <h2>{{ video }}</h2>
    <p class="what_lang">
        {% block lang_display %} 
        in <a href="{% url videos:video video_id=video.video_id %}">Original Language</a>
        {% endblock %}
        {% block translation_list %}
            {% if translations %}
                <p class="other_lang">
                    Other Languages:
                        {% for item in translations %}
                            <a href="{% url videos:translation_history video.video_id item.language %}">{{ item.get_language_display }}</a>{% if not forloop.last %}, {% endif %}
                        {% endfor %}
                 </p>
            {% endif %}
        {% endblock %}        
    </p>
    <div class="left_column">
        {% widget widget_params %}
    </div>
    <div class="right_column">
            </div>
    
    <div class="clearboth">&nbsp;</div>


    
    <ul class="video_tabs">
      <li><a href="#trascript-tab">Languages (4)</a></li>
      <li><a href="#comments-tab">Comments (12)</a></li>
      <li class="active"><a href="#revision-tab">Versions ({{ hits }})</a></li>

    </ul>
    
    <div id="revision-tab" class="tab">
        {% if revision_list %}
           {% if is_paginated %}{% ordered_paginator 3 %}{% endif %} 

           {% block table %}
            <ul class="table_head">
                <li class="table_most_recent">
                    {% ordered_column "date" "Most Recent" %}
                </li>
                <li class="table_user">
                    {% ordered_column "user" "User" %}
                </li>
                <li class="table_note">
                    {% ordered_column "note" "Note" %}
                </li>
                <li class="table_time">
                    {% ordered_column "time" "Time" %}
                </li>
                <li class="table_text">
                    {% ordered_column "text" "Text" %}
                </li>
            </ul>
            
            <ul class="table_body">
                {% for item in revision_list %}
                <li {% cycle 'class="even"' '' %}>
                    <ul>
                        <li class="table_most_recent">
                            <input type="checkbox" class="version_checkbox" value="{{ item.pk }}"/>{{ item.revision_time }} (#{{ item.version_no}}) <a class="view_history" href="{% url videos:revision pk=item.pk %}">view</a>
                        </li>
                        <li class="table_user">
                            <a href="{% url profiles:profile item.user.pk %}">{{ item.user.username }}</a>
                        </li>
                        <li class="table_note">
                            {% if item.note %}{{ item.note }}{% else %}&nbsp;{% endif %}
                        </li>
                        <li class="table_time">
                            {{ item.time_change_display }}
                        </li>
                        <li class="table_text">
                            {{ item.text_change_display }}
                        </li>
                    </ul>
                </li>
                {% endfor %}
            </ul>
            
            <div style="clear: both"></div>
           {% endblock %}
       {% else %}
            <div class="nothing"><strong>This revision has no subtitles</strong><br />
Either no subtitles have been entered, or they were deleted.</div>
       {% endif %}
   </div>
   
   <div style="display: none" id="comments-tab" class="tab">
        <ul class="table_body comments">
            {% for item in revision_list %}
 
                    <li class="table_comment">
                        <div class="table_user_deets">                         
                          <span class="user_thumb"></span>
                         
                          <a href="#">UserName</a>
                          <span class="comment_date">45 days ago</span>
                        </div>
                        <span class="comment_text">
                            <a href="#" class="small_button floatright"><span>Reply</span></a>

                            <p>
                                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed felis nulla, pellentesque a pharetra nec, molestie vel eros. 
                            </p>
                            <p>
                                Donec ut egestas mi. Ut mollis commodo nibh, quis dapibus lacus adipiscing a. Pellentesque tincidunt adipiscing vestibulum. Mauris consequat consequat fringilla. Curabitur lobortis neque non nibh elementum et euismod magna bibendum. Mauris iaculis augue non libero consectetur at vulputate lacus mattis. Proin gravida ipsum vitae sapien aliquet tristique. In hac habitasse platea dictumst. Morbi quis lectus sed libero molestie fermentum vel ac mauris. 
                            </p>
                            <p>
                                Donec scelerisque imperdiet varius. Duis luctus, dolor ac fermentum sodales, risus lorem cursus lectus, vel laoreet tellus diam vitae dolor. Ut vehicula ultricies venenatis. Suspendisse elementum pretium fermentum. Ut ullamcorper viverra rutrum. Fusce luctus rutrum gravida.
                            </p>
                        </span>
                            <ul>
                              <li class="table_comment">
                                <div class="table_user_deets">                         
                                  <span class="user_thumb"></span>
                                 
                                  <a href="#">UserName</a>
                                  <span class="comment_date">45 days ago</span>
                                </div>
                                <span class="comment_text">
                                                              <a href="#" class="small_button floatright"><span>Reply</span></a>

                                    <p>
                                        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed felis nulla, pellentesque a pharetra nec, molestie vel eros. 
                                    </p>
                                    <p>
                                        Donec ut egestas mi. Ut mollis commodo nibh, quis dapibus lacus adipiscing a. Pellentesque tincidunt adipiscing vestibulum. Mauris consequat consequat fringilla. Curabitur lobortis neque non nibh elementum et euismod magna bibendum. Mauris iaculis augue non libero consectetur at vulputate lacus mattis. Proin gravida ipsum vitae sapien aliquet tristique. In hac habitasse platea dictumst. Morbi quis lectus sed libero molestie fermentum vel ac mauris. 
                                    </p>
                                    <p>
                                        Donec scelerisque imperdiet varius. Duis luctus, dolor ac fermentum sodales, risus lorem cursus lectus, vel laoreet tellus diam vitae dolor. Ut vehicula ultricies venenatis. Suspendisse elementum pretium fermentum. Ut ullamcorper viverra rutrum. Fusce luctus rutrum gravida.
                                    </p>
                                </span>
                                <ul>
                                  <li class="table_comment">
                                    <div class="table_user_deets">                         
                                      <span class="user_thumb"></span>
                                     
                                      <a href="#">UserName</a>
                                      <span class="comment_date">45 days ago</span>
                                    </div>
                                    <span class="comment_text">
                                                                  <a href="#" class="small_button floatright"><span>Reply</span></a>

                                        <p>
                                            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed felis nulla, pellentesque a pharetra nec, molestie vel eros. 
                                        </p>
                                        <p>
                                            Donec ut egestas mi. Ut mollis commodo nibh, quis dapibus lacus adipiscing a. Pellentesque tincidunt adipiscing vestibulum. Mauris consequat consequat fringilla. Curabitur lobortis neque non nibh elementum et euismod magna bibendum. Mauris iaculis augue non libero consectetur at vulputate lacus mattis. Proin gravida ipsum vitae sapien aliquet tristique. In hac habitasse platea dictumst. Morbi quis lectus sed libero molestie fermentum vel ac mauris. 
                                        </p>
                                        <p>
                                            Donec scelerisque imperdiet varius. Duis luctus, dolor ac fermentum sodales, risus lorem cursus lectus, vel laoreet tellus diam vitae dolor. Ut vehicula ultricies venenatis. Suspendisse elementum pretium fermentum. Ut ullamcorper viverra rutrum. Fusce luctus rutrum gravida.
                                        </p>
                                    </span>

                                      <ul>
                                        <li class="table_comment">
                                          <div class="table_user_deets">                         
                                            <span class="user_thumb"></span>
                                           
                                            <a href="#">UserName</a>
                                            <span class="comment_date">45 days ago</span>
                                          </div>
                                          <span class="comment_text">
                                                                        <a href="#" class="small_button floatright"><span>Reply</span></a>

                                              <p>
                                                  Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed felis nulla, pellentesque a pharetra nec, molestie vel eros. 
                                              </p>
                                              <p>
                                                  Donec ut egestas mi. Ut mollis commodo nibh, quis dapibus lacus adipiscing a. Pellentesque tincidunt adipiscing vestibulum. Mauris consequat consequat fringilla. Curabitur lobortis neque non nibh elementum et euismod magna bibendum. Mauris iaculis augue non libero consectetur at vulputate lacus mattis. Proin gravida ipsum vitae sapien aliquet tristique. In hac habitasse platea dictumst. Morbi quis lectus sed libero molestie fermentum vel ac mauris. 
                                              </p>
                                              <p>
                                                  Donec scelerisque imperdiet varius. Duis luctus, dolor ac fermentum sodales, risus lorem cursus lectus, vel laoreet tellus diam vitae dolor. Ut vehicula ultricies venenatis. Suspendisse elementum pretium fermentum. Ut ullamcorper viverra rutrum. Fusce luctus rutrum gravida.
                                              </p>
                                          </span>


                                            <ul>
                                              <li class="table_comment">
                                                <div class="table_user_deets">                         
                                                  <span class="user_thumb"></span>
                                                 
                                                  <a href="#">UserName</a>
                                                  <span class="comment_date">45 days ago</span>
                                                </div>
                                                <span class="comment_text">
                                                                              <a href="#" class="small_button floatright"><span>Reply</span></a>

                                                    <p>
                                                        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed felis nulla, pellentesque a pharetra nec, molestie vel eros. 
                                                    </p>
                                                    <p>
                                                        Donec ut egestas mi. Ut mollis commodo nibh, quis dapibus lacus adipiscing a. Pellentesque tincidunt adipiscing vestibulum. Mauris consequat consequat fringilla. Curabitur lobortis neque non nibh elementum et euismod magna bibendum. Mauris iaculis augue non libero consectetur at vulputate lacus mattis. Proin gravida ipsum vitae sapien aliquet tristique. In hac habitasse platea dictumst. Morbi quis lectus sed libero molestie fermentum vel ac mauris. 
                                                    </p>
                                                    <p>
                                                        Donec scelerisque imperdiet varius. Duis luctus, dolor ac fermentum sodales, risus lorem cursus lectus, vel laoreet tellus diam vitae dolor. Ut vehicula ultricies venenatis. Suspendisse elementum pretium fermentum. Ut ullamcorper viverra rutrum. Fusce luctus rutrum gravida.
                                                    </p>
                                                </span>
                                               </li>
                                            </ul>


                                         </li>
                                      </ul>

                                   </li>
                                </ul>
                              </li>
                              <li class="table_comment">
                                <div class="table_user_deets">                         
                                  <span class="user_thumb"></span>
                                 
                                  <a href="#">UserName</a>
                                  <span class="comment_date">45 days ago</span>
                                </div>
                                <span class="comment_text">
                                  
                                    <p>
                                        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed felis nulla, pellentesque a pharetra nec, molestie vel eros. 
                                    </p>
                                    <p>
                                        Donec ut egestas mi. Ut mollis commodo nibh, quis dapibus lacus adipiscing a. Pellentesque tincidunt adipiscing vestibulum. Mauris consequat consequat fringilla. Curabitur lobortis neque non nibh elementum et euismod magna bibendum. Mauris iaculis augue non libero consectetur at vulputate lacus mattis. Proin gravida ipsum vitae sapien aliquet tristique. In hac habitasse platea dictumst. Morbi quis lectus sed libero molestie fermentum vel ac mauris. 
                                    </p>
                                    <p>
                                        Donec scelerisque imperdiet varius. Duis luctus, dolor ac fermentum sodales, risus lorem cursus lectus, vel laoreet tellus diam vitae dolor. Ut vehicula ultricies venenatis. Suspendisse elementum pretium fermentum. Ut ullamcorper viverra rutrum. Fusce luctus rutrum gravida.
                                    </p>
                                </span>
                              </li>
                            </ul>
                    </li>
 
 
        {% endfor %}
       </ul> 
       <div style="clear: both"></div>     
   </div>
   
   <div style="display: none" id="trascript-tab" class="tab">
       
        <ul class="table_head">
          <li class="table_language">Language</li>
          <li class="table_rating">Rating</li>
          <li class="table_done">% Done</li>
        </ul>

        <ul class="table_body"> 
            <li>
              <ul>
                <li class="table_language">English</li>
                <li class="table_rating">A+</li>
                <li class="table_done"><span class="progress"><span class="completion ten_percent red"></span></span></li>
              </ul>
            </li>
            <li>
              <ul>
                <li class="table_language">Hebrew</li>
                <li class="table_rating">A+</li>
                <li class="table_done"><span class="progress"><span class="completion twenty_percent red"></span></span></li>
              </ul>
            </li>
            <li>
              <ul>
                <li class="table_language">Korean</li>
                <li class="table_rating">A+</li>
                <li class="table_done"><span class="progress"><span class="completion thirty_percent red"></span></span></li>
              </ul>
            </li>
            <li>
              <ul>
                <li class="table_language">Japanese</li>
                <li class="table_rating">A+</li>
                <li class="table_done"><span class="progress"><span class="completion fourty_percent yellow"></span></span></li>
              </ul>
            </li>
            <li>
              <ul>
                <li class="table_language">Dutch</li>
                <li class="table_rating">A+</li>
                <li class="table_done"><span class="progress"><span class="completion fifty_percent green"></span></span></li>
              </ul>
            </li>              

       </ul> 

       <div style="clear: both"></div>   
   </div>
{% endblock %}

